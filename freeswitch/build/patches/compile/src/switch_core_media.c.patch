--- switch_core_media.c
+++ switch_core_media.c.new
@@ -2636,7 +2636,7 @@
 	*(buf + datalen) = '\0';
 
 	while (*buf & 0x80) {
-		if (buf + 3 > e) {
+		if (buf + 3 > e || count >= MAX_RED_FRAMES) {
 			*new_datalen = 0;
 			return 0;
 		}
